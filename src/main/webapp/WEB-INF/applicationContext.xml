<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:jee="http://www.springframework.org/schema/jee"
  xmlns:util="http://www.springframework.org/schema/util"
  
  xsi:schemaLocation="http://www.springframework.org/schema/beans 
                http://www.springframework.org/schema/beans/spring-beans.xsd
         http://www.springframework.org/schema/jee 
                http://www.springframework.org/schema/jee/spring-jee-2.0.xsd
         http://www.springframework.org/schema/util
                http://www.springframework.org/schema/util/spring-util-2.5.xsd">

  <!-- First cut at spring config -->
  <jee:jndi-lookup id="jndiRootContext" jndi-name="java:comp/env" />
  
  <bean id="jndiReader" class="nl.xs4all.banaan.tst8.service.impl.JndiReaderImpl">
    <property name="initialContext" ref="jndiRootContext"></property>
  </bean>

  <bean id="propertyReader" 
        class="nl.xs4all.banaan.tst8.service.impl.PropertyReaderImpl" />

  <jee:jndi-lookup id="mailSession" 
        jndi-name="mail/Session" 
        resource-ref="true" />
  
  <bean id="mailSender"
        class="org.springframework.mail.javamail.JavaMailSenderImpl">
    <property name="session" ref="mailSession" />
    <!-- alternatively, you can set host, username, password -->
  </bean>
  
  <bean id="notificator" 
        class="nl.xs4all.banaan.tst8.service.impl.NotificatorImpl">
    <property name="mailSender" ref="mailSender" />
  </bean>
  
 <util:properties id="buildInfoProperties"
    location="classpath:/build.properties"/>
    
  <bean id="buildInfo" class="nl.xs4all.banaan.tst8.service.impl.BuildInfoImpl">
    <property name="properties" ref="buildInfoProperties" />
  </bean>
  
  <bean id="services" class="nl.xs4all.banaan.tst8.service.impl.ServicesImpl">
    <property name="jndiReader" ref="jndiReader" />
    <property name="propertyReader" ref="propertyReader" />
    <property name="notificator" ref="notificator" />
    <property name="buildInfo" ref="buildInfo" />
  </bean>
  
  <bean id="demoApplication" class="nl.xs4all.banaan.tst8.web.DemoApplication">
    <property name="services" ref="services" />
  </bean>

</beans>